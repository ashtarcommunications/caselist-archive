Object.extend(XWiki,{userprofile:{init:function(){this.crtCategory="";this.tabsContainer=$("vertical-tabs");if(!this.tabsContainer){return}this.tabsContainer.select(".vertical-tab").each(function(a){if(!a.__name){a.__name=a.id.replace(/Tab$/,"")}a.observe("click",function(b){Event.stop(b);this.switchTab(a.__name)}.bindAsEventListener(this))}.bind(this));this.tabsContainer.select(".vertical-tab.active").each(function(a){this.updateCategoryFields(a.__name);document.fire("xwiki:profile:switchedCategory",{category:a.__name})}.bind(this));XWiki.userprofile.adjustTabsContainerHeight();this.handleCancelAction()},adjustTabsContainerHeight:function(){var a;$("vertical-panes").select("div.vertical-pane").each(function(b){if(!b.hasClassName("hidden")){a=b}});if(a.getHeight()>$("vertical-tabs").getHeight()){$("vertical-tabs").setStyle({height:a.getHeight()+"px"})}else{$("vertical-tabs").setStyle({height:""})}},switchTab:function(a){$("vertical-panes").select("div.vertical-pane").each(function(b){b.addClassName("hidden")});$("vertical-tabs").setStyle({height:""});$(a+"Pane").removeClassName("hidden");$("vertical-tabs").select("li.vertical-tab").each(function(b){b.removeClassName("active")});$(a+"Tab").addClassName("active");XWiki.userprofile.adjustTabsContainerHeight();this.updateCategoryFields(a);document.fire("xwiki:profile:switchedCategory",{category:a})},updateCategoryFields:function(a){this.crtCategory=a;this.updateField("xredirect",XWiki.currentDocument.getURL("view","category="+a));this.updateField("xcontinue",XWiki.currentDocument.getURL("edit","editor=inline&category="+a));this.updateField("category",a)},updateField:function(c,b){var a=$$("input[name="+c+"]");if(a&&a.size()>0){a[0].value=b}},handleCancelAction:function(){var b=$$("form .buttons input[type=submit][name=action_cancel]");if(b&&b.size()>0){var a=b[0];Event.stopObserving(a,"click");a.observe("click",function(c){c.stop();window.location=XWiki.currentDocument.getURL("view","category="+this.crtCategory)}.bindAsEventListener(this))}}}});Event.observe(window,"load",function(){XWiki.userprofile.init()});document.observe("lightbox:userprofile:loaded",function(){XWiki.userprofile.init()});