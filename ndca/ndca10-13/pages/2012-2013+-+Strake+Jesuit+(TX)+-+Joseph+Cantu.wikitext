See JP's page for theory.