var codeMirrors=[];const TIMEOUT_VALUE=150;if(XWiki.domIsLoaded){initCodeMirrorInternals()}else{document.observe("xwiki:dom:loaded",function(){if(XWiki.contextaction=="edit"){initCodeMirrorInternals()}})}var initCodeMirrorInternals=function(){importCodeMirrorScript("lib/codemirror.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/lib/codemirror.js*/);initCodeMirrorModules();if(XWiki.editor=="wiki"&&insertTags){insertTags=function(b,a,d){var c=codeMirrors[0];if(!c){return}c.replaceSelection(b+(c.doc.getSelection()||d)+a,"end")}}};var initCodeMirrorModules=function(){if(typeof(CodeMirror)!="function"||typeof(CodeMirror.prototype)!="object"){setTimeout(initCodeMirrorModules,TIMEOUT_VALUE)}else{importCodeMirrorScript("mode/css/css.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/css/css.js*/);importCodeMirrorScript("mode/javascript/javascript.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/javascript/javascript.js*/);importCodeMirrorScript("mode/velocity/velocity.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/velocity/velocity.js*/);importCodeMirrorScript("mode/groovy/groovy.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/groovy/groovy.js*/);importCodeMirrorScript("mode/xml/xml.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/xml/xml.js*/);importCodeMirrorScript("mode/htmlmixed/htmlmixed.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/htmlmixed/htmlmixed.js*/);importCodeMirrorScript("mode/python/python.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/mode/python/python.js*/);importScript("/bin/jsx/SyntaxHighlighting/SyntaxHighlightingModes?minify=false");importCodeMirrorScript("addon/search/match-highlighter.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/search/match-highlighter.js*/);importCodeMirrorScript("addon/search/searchcursor.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/search/searchcursor.js*/);importCodeMirrorScript("addon/edit/matchbrackets.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/edit/matchbrackets.js*/);importCodeMirrorScript("addon/selection/active-line.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/selection/active-line.js*/);importCodeMirrorScript("addon/edit/continuecomment.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/edit/continuecomment.js*/);importCodeMirrorScript("addon/edit/closebrackets.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/edit/closebrackets.js*/);importCodeMirrorScript("addon/edit/trailingspace.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/edit/trailingspace.js*/);importCodeMirrorScript("addon/search/search.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/search/search.js*/);importCodeMirrorScript("addon/dialog/dialog.js"/*tpa=http://opencaselist13.paperlessdebate.com/bin/jsx/SyntaxHighlighting/addon/dialog/dialog.js*/);initCodeMirrors()}};var initCodeMirrors=function(){if(XWiki.editor=="object"){initCodeMirror("textarea[id^='XWiki.StyleSheetExtension_'][id$='_code']","css");initCodeMirror("textarea[id^='XWiki.JavaScriptExtension_'][id$='_code']","javascript");initCodeMirror("textarea[id^='XWiki.XWikiSkins_'][id$='.css']","css");initCodeMirror("textarea[id^='XWiki.XWikiSkins_'][id$='.js']","javascript");initCodeMirror("textarea[id^='XWiki.XWikiSkins_'][id$='.vm']","velocity")}else{if(XWiki.editor=="wiki"){initCodeMirror("textarea[id='content']","xwiki")}}};var initCodeMirror=function(e,b){if(CodeMirror.modes[b]==null){setTimeout(function(){initCodeMirror(e,b)},TIMEOUT_VALUE)}else{var a=$$(e);for(var d=0;d<a.length;++d){var c=a[d];if(c.offsetWidth>0||c.offsetHeight>0){initSingleCodeMirror(c,b)}else{var h=c.up(".xobject");var g={};var f=lazyInitObjectEditorCodeMirrors.bindAsEventListener(g,h,c,b);g.listener=f;h.observe("click",f)}}}};var lazyInitObjectEditorCodeMirrors=function(d,c,b,a){initSingleCodeMirror(b,a);c.stopObserving("click",this.listener)};var initSingleCodeMirror=function(b,a){var d=b.getWidth()*100/b.parentNode.getWidth();var c=CodeMirror.fromTextArea(b,{mode:a,lineNumbers:true,matchBrackets:true,autoClearEmptyLines:true,styleActiveLine:true,highlightSelectionMatches:{showToken:/\w+/},continueComments:true,autoCloseBrackets:true,showTrailingSpace:true,extraKeys:{"Ctrl-Space":"autocomplete","Shift-Ctrl-Space":"autocomplete",Tab:whitespaceIndentation,F3:"findNext",F11:function(f){var e=f.getWrapperElement();if(!e.hasClassName("CodeMirror-fullscreen")){var g=e.up().select(".fullScreenEditButton",".fullScreenEditLink")[0];g.click()}},Esc:function(f){var e=f.getWrapperElement();if(e.hasClassName("CodeMirror-fullscreen")){var g=$$(".bottombuttons")[0].down(".button");g.click()}}}});c.getWrapperElement().style.width=""+d+"%";c.refresh();codeMirrors.push(c);return c};var whitespaceIndentation=function(a){if(a.somethingSelected()){a.indentSelection("add")}else{a.replaceSelection(a.getOption("indentWithTabs")?"\t":Array(a.getOption("indentUnit")+1).join(" "),"end","+input")}};var getNewCodeMirrorHeightInFullscreen=function(){var b=$$(".bottombuttons")[0].getHeight();var c=$$(".leftmenu2")[0];var d=0;if(c){d=c.getHeight()}var a=getWindowHeight()-b-d;return a};var getWindowHeight=function(){return window.innerHeight||(document.documentElement||document.body).clientHeight};document.observe("xwiki:actions:save",function(b){for(var a=0;a<codeMirrors.length;++a){codeMirrors[a].save()}});document.observe("xwiki:fullscreen:enter",function(c){var b=getCodeMirrorFromFullScreenEvent(c);var a=b.getWrapperElement();toggleFullscreenEditing.dimensionsBeforeFullscreen={height:a.clientHeight,width:a.clientWidth*100/a.parentNode.getWidth()};toggleFullscreenEditing.scrollBeforeFullscreen=document.viewport.getScrollOffsets()});document.observe("xwiki:fullscreen:entered",function(b){var a=getCodeMirrorFromFullScreenEvent(b);toggleFullscreenEditing(a,true)});document.observe("xwiki:fullscreen:exited",function(b){var a=getCodeMirrorFromFullScreenEvent(b);toggleFullscreenEditing(a,false)});var getCodeMirrorFromFullScreenEvent=function(c){var a=c.memo.target;var d=a.up().down(".CodeMirror textarea");var b=getCodeMirrorFromInternalTextArea(d,codeMirrors);return b};var getCodeMirrorFromInternalTextArea=function(d,e){for(var a=0;a<e.length;++a){var b=e[a];var c=b.getInputField();if(d==c){return b}}};var toggleFullscreenEditing=function(c,b){var a=c.getWrapperElement();if(b){a.addClassName("CodeMirror-fullscreen");a.style.height=getNewCodeMirrorHeightInFullscreen()+"px";a.style.width="100%"}else{a.removeClassName("CodeMirror-fullscreen");a.style.height=toggleFullscreenEditing.dimensionsBeforeFullscreen.height+"px";a.style.width=toggleFullscreenEditing.dimensionsBeforeFullscreen.width+"%";window.scrollTo(toggleFullscreenEditing.scrollBeforeFullscreen.left,toggleFullscreenEditing.scrollBeforeFullscreen.top)}c.refresh();c.focus()};Event.observe(window,"resize",function(b){var a=$$(".CodeMirror-fullscreen")[0];if(!a){return}a.style.height=getNewCodeMirrorHeightInFullscreen()+"px";a.CodeMirror.refresh()});var importScript=function(b){if($$("head script[src='"+b+"']").length!=0){return}var a=document.createElement("script");a.type="text/javascript";a.src=b;document.getElementsByTagName("head")[0].appendChild(a)};var CODEMIRROR_ZIP_URL_TEMPLATE="/bin/download/SyntaxHighlighting/SyntaxHighlighting/codemirror.zip/codemirror-3.14/TEMPLATE";var getCodeMirrorResource=function(a){return CODEMIRROR_ZIP_URL_TEMPLATE.replace("TEMPLATE",a)};var importCodeMirrorScript=function(a){importScript(getCodeMirrorResource(a))};